# fclipboard 需求文档

## 目标与范围
- 目标：提供桌面端（macOS/Windows/Linux）与 Web 的快速内容检索与粘贴工具，本地优先，支持模糊搜索与过滤，同步至自建 REST + Postgres 后端。
- 范围：内容管理、搜索、同步、账户管理、批量导入导出、设置与通知。暂不支持第三方登录、团队协作、实时协同、移动端。

## 用户与场景
- 未登录：本地快速搜/粘贴，最小启动开销。
- 登录用户：多设备同步、云备份、账户自助（注册/登录/密码重置）。
- 管理员：用户与公共库管理（受控入口）。

## 核心功能
- 内容：条目 CRUD，字段 title/body/tags/source/pinned/parameters/createdAt/updatedAt/version/deletedAt(opt)，最近使用与置顶，批量导入导出（JSON/CSV UTF-8）。
- 搜索：标题/正文模糊匹配，标签/来源/时间过滤，排序（相关度、更新时间），桌面全局快捷键唤起与复制，Web 支持页面快捷键与复制按钮。
- 同步：离线优先，本地 SQLite（Web 兼容存储）为主；变更入本地队列；网络恢复自动 push/pull；“最新写 wins”并可保留冲突副本（conflictOf 标记）。
- 账户：邮箱注册/登录/密码重置；JWT + Refresh；可选角色 user/admin。
- 设置：默认排序/过滤、同步间隔、快捷键配置。
- 通知：同步状态、错误提示、健康状态（本地库/网络）。

## 非功能需求
- 性能：本地搜索 <100ms@1k 条，启动 ~<2s。
- 可用性：离线可搜/编，恢复自动同步。
- 安全：传输 TLS；不记录敏感字段；本地默认不加密（预留加密钩子）。

## 假设与依赖
- 后端：FastAPI + Postgres，部署在 Kubernetes；Nginx Ingress + TLS；镜像由 CI/CD 构建推送。
- 客户端：Flutter 3.x，Riverpod + GoRouter；桌面使用 FTS5，Web 用兼容 LIKE/评分。
- 多语言：中/英；UI 简洁、美观、易用。

## 约束与风险
- Web 无全局快捷键：提供页面快捷键与显著复制按钮。
- FTS 差异：抽象搜索评分接口；桌面与 Web 分实现。
- 同步冲突：默认“最新写 wins”，可生成冲突副本提示；需 UI 入口处理。
- 离线场景：读写走本地库，若 push 失败需重试队列与退避。
- 部署：K8s 顺序（迁移、应用）需通过 InitContainer/Job 处理。
